<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://d3j0t7vrtr92dk.cloudfront.net/brakes4less/1691091298_favicon.png" rel="shortcut icon">
  <script>
    function handleSubmit(event) {
      event.preventDefault();
      const formData = new FormData(event.target);
      const data = {};
      formData.forEach((value, key) => {
        if (!data[key]) {
          data[key] = [];
        }
        data[key].push(value);
      });
      const queryString = new URLSearchParams(data).toString();
      const script = document.createElement('script');
      script.src = `https://script.google.com/macros/s/AKfycbyDzXj8xkPHIDZ2Wrnh2S1pQXxJ1rel4zIJ1AWJT5Lh61T6TM6CB_Gu1hz36_W2j5C61Q/exec?callback=jsonpCallback&${queryString}`;
      document.body.appendChild(script);
    }

    function jsonpCallback(response) {
      console.log('Response from server:', response);
      alert('The schedule has been submitted to your District Manager.');
      document.querySelector('form').reset();
      removeAllEmployees();
    }

    function removeAllEmployees() {
      const entries = document.querySelectorAll('.employee-entry');
      entries.forEach(entry => entry.remove());
    }

    function addEmployee() {
      const employeeFields = document.getElementById('employeeFields');
      const newField = document.createElement('div');
      newField.className = 'employee-entry';
      
      const startDate = new Date(document.getElementById('startDate').value);
      const dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
      let dateOptions = '';
      for (let i = 0; i < 14; i++) {
        const date = new Date(startDate);
        date.setDate(date.getDate() + i);
        dateOptions += `<option value="${date.toISOString().split('T')[0]}">${dayNames[date.getDay()]} ${date.toISOString().split('T')[0]}</option>`;
      }
      
      newField.innerHTML = `
        <div class="form-group">
          <label for="employeeName">Employee Name</label>
          <input type="text" name="employeeName" required>
        </div>
        <table>
          <thead>
            <tr>
              <th>Day</th>
              <th>Lunch Time</th>
            </tr>
          </thead>
          <tbody>
            ${dateOptions.split('</option>').map((option, index) => `
            <tr>
              <td>${option.split('>')[1] || ''}</td>
              <td>
                <select name="time_${index}" required>
                  <option value="OFF">OFF</option>
                  <option value="11:00-11:30">11:00 - 11:30</option>
                  <option value="11:30-12:00">11:30 - 12:00</option>
                  <option value="12:00-12:30">12:00 - 12:30</option>
                  <option value="12:30-1:00">12:30 - 1:00</option>
                  <option value="1:00-1:30">1:00 - 1:30</option>
                </select>
              </td>
            </tr>`).join('')}
          </tbody>
        </table>
        <button type="button" class="remove-button" onclick="removeEmployee(this)">Remove</button>
      `;
      employeeFields.appendChild(newField);
      newField.scrollIntoView({ behavior: 'smooth' });
    }

    function removeEmployee(button) {
      const employeeEntry = button.parentNode;
      employeeEntry.remove();
    }
  </script>
  <title>Bi-Weekly Work Schedule</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f4f4f4;
      margin: 0;
      padding: 0;
    }
    .container {
      width: 80%;
      margin: auto;
      overflow: hidden;
    }
    header {
      background: #333;
      color: #fff;
      padding-top: 30px;
      min-height: 70px;
      border-bottom: #77aaff 3px solid;
      text-align: center;
    }
    header a {
      color: #fff;
      text-decoration: none;
      text-transform: uppercase;
      font-size: 16px;
    }
    header ul {
      padding: 0;
      list-style: none;
    }
    header ul li {
      display: inline;
      padding: 0 20px 0 20px;
    }
    .main-content {
      background: #fff;
      padding: 20px;
      margin-top: 20px;
      box-shadow: 0 0 10px #ccc;
    }
    #storeNumber {
      width: 30%;
    }
    h1 {
      text-align: center;
      color: white;
    }
    .form-group {
      margin-bottom: 15px;
    }
    label {
      display: block;
      margin-bottom: 5px;
      color: #333;
    }
    select {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    input[type="text"], input[type="date"] {
      width: 40%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    #addButton {
      display: inline-block;
      padding: 10px 20px;
      font-size: 16px;
      color: #fff;
      background-color: #2647ab;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    #addButton:hover {
      background-color: #1c3378;
    }
    .employee-section {
      margin-top: 20px;
    }
    .employee-section h2 {
      margin-top: 0;
    }
    .employee-entry {
      border: 1px solid #ccc;
      padding: 10px;
      margin-bottom: 10px;
      border-radius: 5px;
      background-color: #f9f9f9;
      position: relative;
    }
    #logo {
      max-width: 25%;
      height: auto;
      margin: 0 auto;
      bottom-padding: 50px;
    }

    #submitButton {
      display: inline-block;
      padding: 10px 20px;
      font-size: 16px;
      color: #fff;
      background-color: #218f50;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    
    #submitButton:hover {
      background-color: #155e35;
    }
    
    .remove-button {
      position: absolute;
      top: 10px;
      right: 10px;
      background-color: #ff4444;
      border: none;
      color: #fff;
      padding: 5px 10px;
      border-radius: 15px;  
      cursor: pointer;
    }

    .remove-button:hover {
      background-color: #ad2b2b;
    }
  </style>
</head>
<body>
  <header>
    <div class="container" text-align="center" bottom-padding="50px" display="inline-block">
      <img id="logo" src="./Brakes-4-Less-Logo-1.png" />
      <h1 text-color="white">Bi-Weekly Work Schedule</h1>
    </div>
  </header>

  <div class="container">
    <div class="main-content">
      <form id="scheduleForm" onsubmit="handleSubmit(event)">
        <div class="form-group">
          <label for="storeNumber">Store Number</label>
          <select id="storeNumber" name="storeNumber" required>
            <option value="">###</option>
            <option value="1">1</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="10">10</option>
            <option value="11">11</option>
            <option value="104">104</option>
            <option value="105">105</option>
            <option value="107">107</option>
            <option value="108">108</option>
            <option value="109">109</option>
            <option value="110">110</option>
            <option value="201">201</option>
            <option value="202">202</option>
            <option value="203">203</option>
            <option value="204">204</option>
            <option value="205">205</option>
            <option value="206">206</option>
            <option value="207">207</option>
            <option value="208">208</option>
            <option value="301">301</option>
            <option value="302">302</option>
            <option value="305">305</option>
            <option value="307">307</option>
            <option value="308">308</option>
            <option value="309">309</option>
            <option value="311">311</option>
            <option value="312">312</option>
            <option value="313">313</option>
            <option value="314">314</option>
            <option value="316">316</option>
            <option value="317">317</option>
            <option value="318">318</option>
            <option value="319">319</option>
            <option value="321">321</option>
            <option value="Admin">Admin</option>
          </select>
        </div>
        <div class="form-group">
          <label for="startDate">Starting Date</label>
          <input type="date" id="startDate" name="startDate" required>
        </div>
        <div class="employee-section">
          <h2>Employee Schedules</h2>
          <div id="employeeFields"></div>
          <button type="button" id="addButton" onclick="addEmployee()">Add Employee</button>
        </div>
        <div class="form-group">
          <button type="submit" id="submitButton">Submit Schedule</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    function addEmployee() {
      const employeeFields = document.getElementById('employeeFields');
      const newField = document.createElement('div');
      newField.className = 'employee-entry';
      
      newField.innerHTML = `
        <div class="form-group">
          <label for="employeeName">Employee Name</label>
          <input type="text" name="employeeName" required>
        </div>
        <table>
          <thead>
            <tr>
              <th>Day</th>
              <th>Lunch Time</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Monday</td>
              <td>
                <select name="mondayTime" required>
                  <option value="OFF">OFF</option>
                  <option value="11:00-11:30">11:00 - 11:30</option>
                  <option value="11:30-12:00">11:30 - 12:00</option>
                  <option value="12:00-12:30">12:00 - 12:30</option>
                  <option value="12:30-1:00">12:30 - 1:00</option>
                  <option value="1:00-1:30">1:00 - 1:30</option>
                </select>
              </td>
            </tr>
            <tr>
              <td>Tuesday</td>
              <td>
                <select name="tuesdayTime" required>
                  <option value="OFF">OFF</option>
                  <option value="11:00-11:30">11:00 - 11:30</option>
                  <option value="11:30-12:00">11:30 - 12:00</option>
                  <option value="12:00-12:30">12:00 - 12:30</option>
                  <option value="12:30-1:00">12:30 - 1:00</option>
                  <option value="1:00-1:30">1:00 - 1:30</option>
                </select>
              </td>
            </tr>
            <tr>
              <td>Wednesday</td>
              <td>
                <select name="wednesdayTime" required>
                  <option value="OFF">OFF</option>
                  <option value="11:00-11:30">11:00 - 11:30</option>
                  <option value="11:30-12:00">11:30 - 12:00</option>
                  <option value="12:00-12:30">12:00 - 12:30</option>
                  <option value="12:30-1:00">12:30 - 1:00</option>
                  <option value="1:00-1:30">1:00 - 1:30</option>
                </select>
              </td>
            </tr>
            <tr>
              <td>Thursday</td>
              <td>
                <select name="thursdayTime" required>
                  <option value="OFF">OFF</option>
                  <option value="11:00-11:30">11:00 - 11:30</option>
                  <option value="11:30-12:00">11:30 - 12:00</option>
                  <option value="12:00-12:30">12:00 - 12:30</option>
                  <option value="12:30-1:00">12:30 - 1:00</option>
                  <option value="1:00-1:30">1:00 - 1:30</option>
                </select>
              </td>
            </tr>
            <tr>
              <td>Friday</td>
              <td>
                <select name="fridayTime" required>
                  <option value="OFF">OFF</option>
                  <option value="11:00-11:30">11:00 - 11:30</option>
                  <option value="11:30-12:00">11:30 - 12:00</option>
                  <option value="12:00-12:30">12:00 - 12:30</option>
                  <option value="12:30-1:00">12:30 - 1:00</option>
                  <option value="1:00-1:30">1:00 - 1:30</option>
                </select>
              </td>
            </tr>
            <tr>
              <td>Saturday</td>
              <td>
                <select name="saturdayTime" required>
                  <option value="OFF">OFF</option>
                  <option value="11:00-11:30">11:00 - 11:30</option>
                  <option value="11:30-12:00">11:30 - 12:00</option>
                  <option value="12:00-12:30">12:00 - 12:30</option>
                  <option value="12:30-1:00">12:30 - 1:00</option>
                  <option value="1:00-1:30">1:00 - 1:30</option>
                </select>
              </td>
            </tr>
          </tbody>
        </table>
        <button type="button" class="remove-button" onclick="removeEmployee(this)">Remove</button>
      `;
      employeeFields.appendChild(newField);
      newField.scrollIntoView({ behavior: 'smooth' });
    }

    function removeEmployee(button) {
      const employeeEntry = button.parentNode;
      employeeEntry.remove();
    }

  </script>
</body>
</html>
